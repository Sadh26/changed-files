name: Get changed files in the src folder
on:
  push:
    paths:
      - 'src/**'

jobs:
  detect-changes:
    runs-on: self-hosted
    steps:
      - name: Check out code
        uses: actions/checkout@v2
      
      - name: Get changed files in the src folder
        id: changed-files-specific
        uses: tj-actions/changed-files@v37
        with:
          files: src/**/*.vi
          separator: ","
      
      - name: Run step if any file(s) in the src folder change
        if: steps.changed-files-specific.outputs.any_changed == 'true'
        run: |
          echo "One or more files in the src folder has changed."
          echo "List all the files that have changed: ${{ steps.changed-files-specific.outputs.all_changed_files }}"
      
      - name: Check if Tests folder has changed
        id: tests-folder-changed
        run: |
          echo "${{ steps.changed-files-specific.outputs.all_changed_files }}" | grep -q 'src/Tests/'
          echo "tests_folder_changed=${PIPESTATUS[1]}" >> $GITHUB_ENV
      
      - name: Run tests in the Tests folder if they changed
        if: steps.tests-folder-changed.outputs.tests_folder_changed == '0'
        run: |
          echo "Running tests in the Tests folder"
          # Add your test running commands here for the Tests folder
